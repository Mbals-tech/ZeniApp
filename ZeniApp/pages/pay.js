import { useRouter } from 'next/router'; import { PACKAGES } from ' ./utils/packages'; import { useState, useEffect } from 'react'; export default function Pay(){ const router = useRouter(); const { pkg } = router.query; const [settings,setSettings] = useState(null); useEffect(()=>{ fetch('/api/admin/settings').then(r=>r.json()).then(setSettings); }, []); const p = PACKAGES[pkg] || null; if(!p) return <div style={{padding:40}}>Select a package from <a href="/">Home</a></div>; return ( <div style={{maxWidth:800, margin:'40px auto', fontFamily:'sans-serif', padding:'0 16px'}}> <h2>Pay for {p.key}</h2> <div style={{border:'1px solid #ddd', padding:16}}> <div><strong>Bank:</strong> {settings?.bank_name || 'Tyme Bank'}</div> <div><strong>Account:</strong> {settings?.bank_account || '53001355373'}</div> <div><strong>Reference:</strong> Use the phone number you used to register</div> <div style={{marginTop:12}}> <a href="#upload">I have paid — upload proof</a> </div> </div> <div id="upload" style={{marginTop:20}}> <h3>Upload proof of payment</h3> <form method="post" encType="multipart/form-data" onSubmit={async e=>{ e.preventDefault(); const fd = new FormData(e.target); const create = await fetch('/api/investments', { method:'POST', headers:{'content-type':'application/json'}, body: JSON.stringify({ package_key: p.key })}); const createJson = await create.json(); const invId = createJson.id; fd.append('invId', invId); const proofRes = await fetch('/api/investments/'+invId+'/proof', { method:'POST', body: fd }); if(proofRes.ok) alert('Proof uploaded — admin will verify'); }}> <input type="file" name="proof" required/> <button type="submit">Upload Proof & Create Investment</button> </form> </div> </div> ); }
