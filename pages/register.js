import { useState } from 'react'; import { useRouter } from 'next/router'; export default function Register(){ const [fullName,setFullName] = useState(''); const [phone,setPhone] = useState(''); const [email,setEmail] = useState(''); const [password,setPassword] = useState(''); const [err,setErr] = useState(''); const router = useRouter(); const { ref } = router.query; async function submit(e){ e.preventDefault(); setErr(''); try { const res = await fetch('/api/auth/register', { method:'POST', headers:{'content-type':'application/json'}, body: JSON.stringify({ full_name: fullName, phone, email, password, ref })}); const j = await res.json(); if(!res.ok) return setErr(j.error || 'Registration failed'); localStorage.setItem('token', j.token); router.push('/dashboard'); } catch(e){ setErr('Network error'); } } return ( <div style={{maxWidth:600, margin:'40px auto', fontFamily:'sans-serif', padding:'0 16px'}}> <h2>Register</h2> <form onSubmit={submit}> <label>Full name<br/><input value={fullName} onChange={e=>setFullName(e.target.value)} required/></label><br/><br/> <label>Phone number<br/><input value={phone} onChange={e=>setPhone(e.target.value)} required/></label><br/><br/> <label>Email (optional)<br/><input value={email} onChange={e=>setEmail(e.target.value)} /></label><br/><br/> <label>Password<br/><input type="password" value={password} onChange={e=>setPassword(e.target.value)} required/></label><br/><br/> {err && <div style={{color:'red'}}>{err}</div>} <button type="submit">Register</button> </form> </div> ); }
